<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Details - ShopHub</title>
  <meta name="description" content="View detailed information about our products and add them to your cart.">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- Navigation Bar -->
  <nav class="navbar">
    <div class="navbar-container">
      <a href="index.html" class="navbar-logo">üõçÔ∏è ShopHub</a>
      
      <div class="search-bar">
        <input type="search" id="search-input" class="search-input" placeholder="Search products...">
        <button id="search-btn" class="search-btn">Search</button>
      </div>

      <button class="hamburger" aria-label="Toggle navigation menu">
        <span></span>
        <span></span>
        <span></span>
      </button>

      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="products.html">All Products</a></li>
        <li><a href="cart.html" class="cart-link">
          üõí Cart
          <span id="cart-count"></span>
        </a></li>
      </ul>
    </div>
  </nav>

  <!-- Product Details Container -->
  <div class="product-details-container">
    <a href="products.html" class="back-btn">‚Üê Back to Products</a>

    <div id="product-detail" class="product-details">
      <!-- Product details will be injected here -->
    </div>
  </div>

  <!-- Related Products Section -->
  <section class="products" style="background-color: #f9f9f9; margin-top: 40px;">
    <div class="products-container">
      <h2 class="section-title">You Might Also Like</h2>
      <div class="products-grid" id="related-products">
        <!-- Related products will be injected here -->
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-section">
        <h3>About ShopHub</h3>
        <ul>
          <li><a href="#">About Us</a></li>
          <li><a href="#">Careers</a></li>
          <li><a href="#">Blog</a></li>
          <li><a href="#">Press</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h3>Customer Service</h3>
        <ul>
          <li><a href="#">Contact Us</a></li>
          <li><a href="#">Help Center</a></li>
          <li><a href="#">Track Order</a></li>
          <li><a href="#">Returns</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h3>Policies</h3>
        <ul>
          <li><a href="#">Privacy Policy</a></li>
          <li><a href="#">Terms of Service</a></li>
          <li><a href="#">Shipping Info</a></li>
          <li><a href="#">Security</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h3>Newsletter</h3>
        <p>Subscribe to get special offers and updates!</p>
        <div class="footer-newsletter">
          <input type="email" placeholder="Enter your email" required>
          <button>Subscribe</button>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2024 ShopHub. All rights reserved. | Design with ‚ù§Ô∏è for great shopping experience</p>
    </div>
  </footer>

  <!-- Scroll to Top Button -->
  <button id="scroll-to-top" aria-label="Scroll to top">‚Üë</button>

  <!-- Scripts -->
  <script src="js/data.js"></script>
  <script src="js/cart.js"></script>
  <script src="js/main.js"></script>
  <script>
    // Product details page functionality
    let currentQuantity = 1;
    let currentProduct = null;

    document.addEventListener('DOMContentLoaded', () => {
      const productId = getURLParam('id');

      if (!productId) {
        document.getElementById('product-detail').innerHTML = `
          <div class="error-container">
            <div class="error-icon">‚ö†Ô∏è</div>
            <h2 class="error-title">Product Not Found</h2>
            <p class="error-message">The product you're looking for doesn't exist.</p>
            <a href="products.html" class="error-btn">Go to Products</a>
          </div>
        `;
        return;
      }

      currentProduct = getProductById(parseInt(productId));

      if (!currentProduct) {
        document.getElementById('product-detail').innerHTML = `
          <div class="error-container">
            <div class="error-icon">‚ö†Ô∏è</div>
            <h2 class="error-title">Product Not Found</h2>
            <p class="error-message">The product you're looking for doesn't exist.</p>
            <a href="products.html" class="error-btn">Go to Products</a>
          </div>
        `;
        return;
      }

      renderProductDetails();
      renderRelatedProducts();
    });

    // Render product details
    function renderProductDetails() {
      const discount = getDiscountPercentage(currentProduct.price, currentProduct.originalPrice);
      const isInCart = cart.hasItem(currentProduct.id);

      const detailHTML = `
        <div class="product-images">
          <img src="${currentProduct.image}" alt="${currentProduct.name}" class="main-image" id="main-image">
          <div class="thumbnail-images">
            <img src="${currentProduct.image}" class="thumbnail-image active" onclick="changeImage('${currentProduct.image}')">
            <img src="${currentProduct.image}" class="thumbnail-image" onclick="changeImage('${currentProduct.image}')">
            <img src="${currentProduct.image}" class="thumbnail-image" onclick="changeImage('${currentProduct.image}')">
            <img src="${currentProduct.image}" class="thumbnail-image" onclick="changeImage('${currentProduct.image}')">
          </div>
        </div>

        <div class="product-details-info">
          <h1 class="product-details-title">${currentProduct.name}</h1>

          <div class="product-details-rating">
            <div class="stars">${createRatingStars(currentProduct.rating)}</div>
            <span class="rating-text">${currentProduct.rating}</span>
            <span class="reviews-count">${currentProduct.reviews} reviews</span>
          </div>

          <div class="product-details-price">
            <span class="details-current-price">${formatCurrency(currentProduct.price)}</span>
            <span class="details-original-price">${formatCurrency(currentProduct.originalPrice)}</span>
            <span class="details-discount">${discount}% OFF</span>
          </div>

          <p class="product-description">${currentProduct.description}</p>

          <div class="product-features">
            <div class="features-title">Key Features</div>
            <ul class="features-list">
              ${currentProduct.features.map(feature => `<li>${feature}</li>`).join('')}
            </ul>
          </div>

          <div class="quantity-selector">
            <span>Quantity:</span>
            <button class="quantity-btn" onclick="decreaseQuantity()">‚àí</button>
            <span class="quantity-display" id="quantity-display">${currentQuantity}</span>
            <button class="quantity-btn" onclick="increaseQuantity()">+</button>
          </div>

          <button class="add-to-cart-large" onclick="addCurrentProductToCart()">
            ${isInCart ? '‚úì Already in Cart - Add More' : 'Add to Cart'}
          </button>

          <div style="background-color: #f0f4ff; padding: 16px; border-radius: 8px; margin-top: 16px;">
            <p style="font-size: 14px; color: #666; margin-bottom: 8px;">‚úì Free shipping on orders above 500</p>
            <p style="font-size: 14px; color: #666; margin-bottom: 8px;">‚úì 14-day money-back guarantee</p>
            <p style="font-size: 14px; color: #666;">‚úì Safe and secure checkout</p>
          </div>
        </div>
      `;

      document.getElementById('product-detail').innerHTML = detailHTML;
    }

    // Change main image
    function changeImage(imageSrc) {
      document.getElementById('main-image').src = imageSrc;
      document.querySelectorAll('.thumbnail-image').forEach(img => {
        img.classList.remove('active');
        if (img.src.includes(imageSrc.split('/').pop())) {
          img.classList.add('active');
        }
      });
    }

    // Increase quantity
    function increaseQuantity() {
      currentQuantity++;
      document.getElementById('quantity-display').textContent = currentQuantity;
    }

    // Decrease quantity
    function decreaseQuantity() {
      if (currentQuantity > 1) {
        currentQuantity--;
        document.getElementById('quantity-display').textContent = currentQuantity;
      }
    }

    // Add current product to cart
    function addCurrentProductToCart() {
      if (currentProduct) {
        cart.addItem(currentProduct.id, currentQuantity);
        showToast(`${currentProduct.name} added to cart! (Quantity: ${currentQuantity})`);
        currentQuantity = 1;
        document.getElementById('quantity-display').textContent = currentQuantity;
        renderProductDetails(); // Update button text
      }
    }

    // Render related products
    function renderRelatedProducts() {
      const relatedProducts = getAllProducts()
        .filter(p => p.category === currentProduct.category && p.id !== currentProduct.id)
        .slice(0, 4);

      const relatedContainer = document.getElementById('related-products');
      relatedContainer.innerHTML = relatedProducts.length > 0
        ? relatedProducts.map(product => createProductCard(product)).join('')
        : '<p style="grid-column: 1/-1; text-align: center; padding: 40px; color: #666;">No related products found</p>';
    }
  </script>
</body>
</html>
